<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <link rel="icon" href="/ctf-writeups/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="dl1D1u59Q1pKaeEVUFtuHxnfuBFKhks8hA19r7WuxTY">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Judson:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gabarito:wght@400..900&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400..600" rel="stylesheet">
    <title>TISC 2023 - KPA</title>
    <script type="module" crossorigin="" src="/ctf-writeups/assets/app-bec233ca.js"></script>
    <link rel="stylesheet" href="/ctf-writeups/assets/index-ce236130.css">
  <meta property="article:tag" content="TISC 2023"><meta property="article:tag" content="mobile"><meta name="description" content="# 1. Fixing the apk

When I first tried to decompile the apk with jadx, it produced an error and failed to decompile correctly. I remembered from the challenge description that &quot;some of the last few bytes got corrupted&quot;, so I knew I had to fix the file before decompiling it. I searched for an apk file format specification online but realised an apk is a zip archive, so I used the specification [here](https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip-printable.html) and edited the file using ghex.

Referring to the &quot;end of central directory record&quot; section, I realised that the comment length was set to \x0a\x00 = 10 bytes, although the challenge description specified &quot;the file shouldn't have any comments&quot;. Hence, I just changed the byte to 0 and decompiled the modified apk. This time, it decompiled without errors.

# 2. Static analysis

Next, I found MainActivity.java under sources/com/tisc/kappa/MainActivity.java, and I noticed an interesting method.

```java:MainActivity.java
public void M(String str) {
    char[] charArray = str.toCharArray();
    String valueOf = String.valueOf(charArray);
    for (int i2 = 0; i2 < 1024; i2++) {
        valueOf = N(valueOf, &quot;SHA1&quot;);
    }
    if (!valueOf.equals(&quot;d8655ddb9b7e6962350cc68a60e02cc3dd910583&quot;)) {
        ((TextView) findViewById(d.f3935f)).setVisibility(4);
        Q(d.f3930a, 3000);
        return;
    }
    char[] copyOf = Arrays.copyOf(charArray, charArray.length);
    charArray[0] = (char) ((copyOf[24] * 2) + 1);
    charArray[1] = (char) (((copyOf[23] - 1) / 4) * 3);
    charArray[2] = Character.toLowerCase(copyOf[22]);
    charArray[3] = (char) (copyOf[21] + '&amp;');
    charArray[4] = (char) ((Math.floorDiv((int) copyOf[20], 3) * 5) + 4);
    charArray[5] = (char) (copyOf[19] - 1);
    charArray[6] = (char) (copyOf[18] + '1');
    charArray[7] = (char) (copyOf[17] + 18);
    charArray[8] = (char) ((copyOf[16] + 19) / 3);
    charArray[9] = (char) (copyOf[15] + '%');
    charArray[10] = (char) (copyOf[14] + '2');
    charArray[11] = (char) (((copyOf[13] / 5) + 1) * 3);
    charArray[12] = (char) ((Math.floorDiv((int) copyOf[12], 9) + 5) * 9);
    charArray[13] = (char) (copyOf[11] + 21);
    charArray[14] = (char) ((copyOf[10] / 2) - 6);
    charArray[15] = (char) (copyOf[9] + 2);
    charArray[16] = (char) (copyOf[8] - 24);
    charArray[17] = (char) (copyOf[7] + Math.pow(4.0d, 2.0d));
    charArray[18] = (char) ((copyOf[6] - '\t') / 2);
    charArray[19] = (char) (copyOf[5] + '\b');
    charArray[20] = copyOf[4];
    charArray[21] = (char) (copyOf[3] - '\&quot;');
    charArray[22] = (char) ((copyOf[2] * 2) - 20);
    charArray[23] = (char) ((copyOf[1] / 2) + 8);
    charArray[24] = (char) ((copyOf[0] + 1) / 2);
    P(&quot;The secret you want is TISC{&quot; + String.valueOf(charArray) + &quot;}&quot;, &quot;CONGRATULATIONS!&quot;, &quot;YAY&quot;);
}
```

Unfortunately, it seems that `str` is user-entered, and there is no way to reverse the sha1 hashes, hence we have to look elsewhere. At this point, I installed the apk on my phone, and saw that there was the following dialog:

![Screenshot of the app](/ctf-writeups/tisc23/kpa-screenshot.jpg)

I realised this is loaded by the onResume method: 

```java:MainActivity.java
@Override // androidx.fragment.app.e, android.app.Activity
public void onResume() {
    super.onResume();
    O(j1.c.f3928a);
    new j1.b();
    if (j1.b.e()) {
        P(&quot;Suspicious device detected!&quot;, &quot;CHECK FAILED&quot;, &quot;BYE&quot;);
    }
    PackageManager packageManager = getPackageManager();
    new j1.a();
    if (j1.a.a(packageManager) == 20) {
        O(j1.c.f3929b);
        setContentView(e.f3937b);
        new sw();
        sw.a();
        ((Button) findViewById(d.f3934e)).setOnClickListener(new c());
        return;
    }
    O(j1.c.f3928a);
    setContentView(e.f3936a);
    if (j1.b.e()) {
        return;
    }
    ((TextView) findViewById(d.f3932c)).setAlpha(1.0f);
    ((TextView) findViewById(d.f3933d)).setAlpha(1.0f);
}
```

It seems that some conditions are being checked, and depending on the outcome `setContentView` will be called with either `e.f3937b` or `e.f3936a`. I looked at the e.java class to find:

```java:e.java
package j1;
/* loaded from: classes.dex */
public abstract class e {

    /* renamed from: a  reason: collision with root package name */
    public static int f3936a = 2131427356;

    /* renamed from: b  reason: collision with root package name */
    public static int f3937b = 2131427358;
}
```

Now we need to find the layout file with these ids. By conducting a global search for the hex value of these ids, I found these lines in resources/res/values/public.xml:

```xml:public.xml
<public type=&quot;layout&quot; name=&quot;activity_main&quot; id=&quot;0x7f0b001c&quot; />
<public type=&quot;layout&quot; name=&quot;debug_activity_main&quot; id=&quot;0x7f0b001e&quot; />
```

`activity_main` seems to be the layout that was loaded when I opened the app, however if the `j1.a.a(packageManager) == 20` condition is satisfied (it seems to check that a certain list of 20 packages are installed), `debug_activity_main` is loaded instead. I found the layout file under resources/res/layout/debug_activity_main.xml:

```xml:debug_activity_main.xml
<?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?>
<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; android:background=&quot;#8bffb8&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot;>
    <TextView android:textSize=&quot;18sp&quot; android:id=&quot;@+id/textView2&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;The secret you seek was just written somewhere...&quot; android:textAlignment=&quot;center&quot; app:layout_constraintBottom_toBottomOf=&quot;0&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintStart_toStartOf=&quot;0&quot; app:layout_constraintTop_toTopOf=&quot;0&quot; app:layout_constraintVertical_bias=&quot;0.366&quot;/>
    <TextView android:textSize=&quot;34sp&quot; android:typeface=&quot;normal&quot; android:textStyle=&quot;bold&quot; android:textColor=&quot;#292929&quot; android:id=&quot;@+id/textView&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:text=&quot;Welcome to KaPpA!&quot; android:autoText=&quot;false&quot; android:textAllCaps=&quot;false&quot; app:layout_constraintBottom_toBottomOf=&quot;0&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintStart_toStartOf=&quot;0&quot; app:layout_constraintTop_toTopOf=&quot;0&quot; app:layout_constraintVertical_bias=&quot;0.189&quot;/>
    <Button android:id=&quot;@+id/submitButton&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginTop=&quot;18dp&quot; android:text=&quot;Submit!&quot; android:layout_marginStart=&quot;157dp&quot; android:layout_marginEnd=&quot;157dp&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintStart_toStartOf=&quot;0&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/inputText&quot;/>
    <EditText android:id=&quot;@+id/inputText&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginTop=&quot;102dp&quot; android:layout_marginBottom=&quot;18dp&quot; android:hint=&quot;Think you found it?&quot; android:ems=&quot;10&quot; android:inputType=&quot;text&quot; android:textAlignment=&quot;center&quot; android:layout_marginStart=&quot;100dp&quot; android:layout_marginEnd=&quot;102dp&quot; app:layout_constraintBottom_toTopOf=&quot;@+id/submitButton&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintStart_toStartOf=&quot;0&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/textView2&quot; style=&quot;@style/Widget.AppCompat.EditText&quot;/>
    <TextView android:textSize=&quot;20sp&quot; android:textColor=&quot;#009688&quot; android:id=&quot;@+id/success&quot; android:visibility=&quot;invisible&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginTop=&quot;56dp&quot; android:text=&quot;Getting there...&quot; android:layout_marginStart=&quot;160dp&quot; android:layout_marginEnd=&quot;160dp&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintHorizontal_bias=&quot;0.503&quot; app:layout_constraintStart_toStartOf=&quot;0&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/submitButton&quot;/>
    <TextView android:textSize=&quot;20sp&quot; android:textColor=&quot;#e91e63&quot; android:id=&quot;@+id/failure&quot; android:visibility=&quot;invisible&quot; android:layout_width=&quot;wrap_content&quot; android:layout_height=&quot;wrap_content&quot; android:layout_marginTop=&quot;76dp&quot; android:text=&quot;That&amp;apos;s not right...&quot; android:layout_marginEnd=&quot;128dp&quot; app:layout_constraintEnd_toEndOf=&quot;0&quot; app:layout_constraintTop_toBottomOf=&quot;@+id/submitButton&quot;/>
</androidx.constraintlayout.widget.ConstraintLayout>
```

So this is where the user keys in the secret, which is passed to the method we saw earlier. There is an important hint &quot;The secret you seek was just written somewhere&quot;. Initially I thought it had been written to a file, so I took another look at the java code near where `setContentView` is called. the lines `new sw(); sw.a();` seemed interesting, so I looked at sw.java:

```java:sw.java
package com.tisc.kappa;
/* loaded from: classes.dex */
public class sw {
    static {
        System.loadLibrary(&quot;kappa&quot;);
    }

    public static void a() {
        try {
            System.setProperty(&quot;KAPPA&quot;, css());
        } catch (Exception unused) {
        }
    }

    private static native String css();
}
```

Maybe the secret is stored in the kappa library, perhaps its written to a file when the library is loaded? I found the `libkappa.so` file under `resources/lib/x86_64/libkappa.so` and began to analyse it. I tried running strings and attempted to decompile it, however this wasn't successful. In the end, I used a more dynamic approach.

I simply created a new android app, copying the contents of `resources/lib` over to `jniLibs`, and copying the `sw.java` file. I created a separate line, `String s = css();`, and added a breakpoint right after that. When I debugged the app, I could see the secret in the variable `s`: `&quot;ArBraCaDabra?KAPPACABANA!&quot;`

Now its just a matter of running the above method (`M`) to transform the string and print the flag. I made a few modifications to the code, and ran it on an online java compiler.

```java:s.java
import java.util.Arrays;

public class HelloWorld {
    public static void main(String[] args) {
        String str = &quot;ArBraCaDabra?KAPPACABANA!&quot;;
        char[] charArray = str.toCharArray();
        String valueOf = String.valueOf(charArray);
        char[] copyOf = Arrays.copyOf(charArray, charArray.length);
        charArray[0] = (char) ((copyOf[24] * 2) + 1);
        charArray[1] = (char) (((copyOf[23] - 1) / 4) * 3);
        charArray[2] = Character.toLowerCase(copyOf[22]);
        charArray[3] = (char) (copyOf[21] + '&amp;');
        charArray[4] = (char) ((Math.floorDiv((int) copyOf[20], 3) * 5) + 4);
        charArray[5] = (char) (copyOf[19] - 1);
        charArray[6] = (char) (copyOf[18] + '1');
        charArray[7] = (char) (copyOf[17] + 18);
        charArray[8] = (char) ((copyOf[16] + 19) / 3);
        charArray[9] = (char) (copyOf[15] + '%');
        charArray[10] = (char) (copyOf[14] + '2');
        charArray[11] = (char) (((copyOf[13] / 5) + 1) * 3);
        charArray[12] = (char) ((Math.floorDiv((int) copyOf[12], 9) + 5) * 9);
        charArray[13] = (char) (copyOf[11] + 21);
        charArray[14] = (char) ((copyOf[10] / 2) - 6);
        charArray[15] = (char) (copyOf[9] + 2);
        charArray[16] = (char) (copyOf[8] - 24);
        charArray[17] = (char) (copyOf[7] + Math.pow(4.0d, 2.0d));
        charArray[18] = (char) ((copyOf[6] - '\t') / 2);
        charArray[19] = (char) (copyOf[5] + '\b');
        charArray[20] = copyOf[4];
        charArray[21] = (char) (copyOf[3] - '\&quot;');
        charArray[22] = (char) ((copyOf[2] * 2) - 20);
        charArray[23] = (char) ((copyOf[1] / 2) + 8);
        charArray[24] = (char) ((copyOf[0] + 1) / 2);
        System.out.println(&quot;The secret you want is TISC{&quot; + String.valueOf(charArray) + &quot;}&quot;);
    }
}
```

The flag was printed out: `TISC{C0ngr@tS!us0lv3dIT,KaPpA!}`
"><meta name="author" content="Jia Jie"></head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="w-full fixed z-20 bg-[#1e1e1e] flex flex-col items-center transition-transform duration-500"><div class="w-full h-16 flex-shrink-0 flex items-center justify-between px-10 max-sm:px-5 max-sm:h-14"><div class="w-10 h-10 flex flex-col items-center justify-center gap-y-1 cursor-pointer mr-3 xl:hidden" data-v-eaee368e=""><div class="bar b1" data-v-eaee368e=""></div><div class="bar b2" data-v-eaee368e=""></div><div class="bar b3" data-v-eaee368e=""></div></div><span class="text-xl font-semibold">Jia Jie's writeups</span><div class="flex-1"></div><button class="group w-10 h-10 rounded-full grid place-items-center"><i class="material-symbols-outlined text-2xl transition-colors group-hover:text-primary">search</i></button><a href="https://github.com/mkofdwu/ctf-writeups" target="_blank" class="group w-10 h-10 rounded-full grid place-items-center"><svg width="28" height="28" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" class="transition-colors fill-white group-hover:fill-primary"><path d="M18.0015 3C9.71403 3 3.00153 9.7125 3.00153 18C2.99972 21.1487 3.98943 24.2181 5.83024 26.7727C7.67106 29.3273 10.2695 31.2373 13.257 32.232C14.007 32.3625 14.289 31.9125 14.289 31.518C14.289 31.1625 14.2695 29.982 14.2695 28.725C10.5015 29.4195 9.52653 27.807 9.22653 26.9625C9.05703 26.5305 8.32653 25.2 7.68903 24.843C7.16403 24.5625 6.41403 23.868 7.66953 23.85C8.85153 23.8305 9.69453 24.9375 9.97653 25.3875C11.3265 27.6555 13.482 27.018 14.3445 26.625C14.4765 25.65 14.8695 24.9945 15.3015 24.6195C11.964 24.2445 8.47653 22.95 8.47653 17.2125C8.47653 15.5805 9.05703 14.232 10.014 13.1805C9.86403 12.8055 9.33903 11.268 10.164 9.2055C10.164 9.2055 11.4195 8.8125 14.289 10.7445C15.5101 10.4056 16.7718 10.235 18.039 10.2375C19.314 10.2375 20.589 10.4055 21.789 10.743C24.6585 8.793 25.914 9.207 25.914 9.207C26.739 11.2695 26.214 12.807 26.064 13.182C27.0195 14.232 27.6015 15.5625 27.6015 17.2125C27.6015 22.9695 24.096 24.2445 20.757 24.6195C21.3015 25.0875 21.771 25.9875 21.771 27.3945C21.771 29.4 21.7515 31.0125 21.7515 31.5195C21.7515 31.9125 22.0335 32.3805 22.7835 32.2305C25.7608 31.2249 28.3478 29.3111 30.1805 26.7584C32.0132 24.2056 32.9993 21.1425 33 18C33 9.7125 26.2875 3 18 3H18.0015Z"></path></svg></a><a href="https://mkofdwu.github.io/" target="_blank" class="main-website-btn group h-10 pl-4 pr-2 ml-3 flex items-center font-semibold rounded-full border max-[500px]:hidden transition-all duration-500 hover:border-primary hover:text-black"> main website <i class="material-symbols-outlined text-2xl text-xl ml-2 transition-colors duration-500 group-hover:text-black">arrow_outward</i></a><div class="h-0 hide-scrollbar fixed left-0 top-16 z-10 w-full bg-black overflow-y-auto origin-top duration-300 transition-all xl:hidden max-sm:top-14"><div class="opacity-0 pt-10 duration-300 transition-opacity"><div class="flex flex-col" full-width="true"><!--[--><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">idek 2025</span><!--[--><a href="/ctf-writeups/ctfinder" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">CTFinder</span></a><a href="/ctf-writeups/jnotes" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">jnotes</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Codegate 2025 Quals</span><!--[--><a href="/ctf-writeups/masquerade" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Masquerade</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2024</span><!--[--><a href="/ctf-writeups/navigating-the-digital-labyrinth" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 1</span></a><a href="/ctf-writeups/language-labyrinth-and-graphicsmagick" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 2</span></a><a href="/ctf-writeups/digging-up-history" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 3</span></a><a href="/ctf-writeups/alligatorpay" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 4</span></a><a href="/ctf-writeups/hardware-isnt-that-hard" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 5</span></a><a href="/ctf-writeups/noncevigator" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 6</span></a><a href="/ctf-writeups/baby-flagchecker" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 7</span></a><a href="/ctf-writeups/wallfacer" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 8</span></a><a href="/ctf-writeups/imphash" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 9</span></a><a href="/ctf-writeups/diffuse" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 10</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Greyhats 2024</span><!--[--><a href="/ctf-writeups/proto-grader" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Proto Grader</span></a><a href="/ctf-writeups/hi-doggy" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Hi Doggy</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">UIUCTF 2024</span><!--[--><a href="/ctf-writeups/push-and-pickle" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Push and Pickle</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2023</span><!--[--><a href="/ctf-writeups/disk-archaeology" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 1</span></a><a href="/ctf-writeups/reckless-mistake" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 2</span></a><a aria-current="page" href="/ctf-writeups/kpa" class="router-link-active router-link-exact-active group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-primary" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10 text-primary">Level 3</span></a><a href="/ctf-writeups/rubg" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 4</span></a><a href="/ctf-writeups/palindromes-invitation" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 5</span></a><a href="/ctf-writeups/the-chosen-ones" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 6</span></a><a href="/ctf-writeups/devsecmeow" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 7</span></a><a href="/ctf-writeups/blind-sql-injection" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 8</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">LITCTF 2023</span><!--[--><a href="/ctf-writeups/the-other-obligatory-pyjail" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">the other obligatory pyjail</span></a><!--]--></div><!--]--></div></div></div></div><div class="dotted-line-hori z-10 w-[calc(100vw-5rem)] max-sm:w-screen"></div></div><div class="fixed z-10 w-[17.5rem] h-screen overflow-y-hidden flex max-xl:hidden"><div class="flex flex-col hide-scrollbar h-full overflow-y-auto pt-24 pr-5"><!--[--><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">idek 2025</span><!--[--><a href="/ctf-writeups/ctfinder" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">CTFinder</span></a><a href="/ctf-writeups/jnotes" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">jnotes</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Codegate 2025 Quals</span><!--[--><a href="/ctf-writeups/masquerade" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Masquerade</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2024</span><!--[--><a href="/ctf-writeups/navigating-the-digital-labyrinth" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 1</span></a><a href="/ctf-writeups/language-labyrinth-and-graphicsmagick" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 2</span></a><a href="/ctf-writeups/digging-up-history" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 3</span></a><a href="/ctf-writeups/alligatorpay" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 4</span></a><a href="/ctf-writeups/hardware-isnt-that-hard" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 5</span></a><a href="/ctf-writeups/noncevigator" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 6</span></a><a href="/ctf-writeups/baby-flagchecker" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 7</span></a><a href="/ctf-writeups/wallfacer" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 8</span></a><a href="/ctf-writeups/imphash" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 9</span></a><a href="/ctf-writeups/diffuse" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 10</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Greyhats 2024</span><!--[--><a href="/ctf-writeups/proto-grader" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Proto Grader</span></a><a href="/ctf-writeups/hi-doggy" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Hi Doggy</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">UIUCTF 2024</span><!--[--><a href="/ctf-writeups/push-and-pickle" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Push and Pickle</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2023</span><!--[--><a href="/ctf-writeups/disk-archaeology" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 1</span></a><a href="/ctf-writeups/reckless-mistake" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 2</span></a><a aria-current="page" href="/ctf-writeups/kpa" class="router-link-active router-link-exact-active group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-primary" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10 text-primary">Level 3</span></a><a href="/ctf-writeups/rubg" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 4</span></a><a href="/ctf-writeups/palindromes-invitation" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 5</span></a><a href="/ctf-writeups/the-chosen-ones" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 6</span></a><a href="/ctf-writeups/devsecmeow" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 7</span></a><a href="/ctf-writeups/blind-sql-injection" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">Level 8</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">LITCTF 2023</span><!--[--><a href="/ctf-writeups/the-other-obligatory-pyjail" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-1"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors stroke-[#424242] group-hover:stroke-primary/30" stroke-width="2"></path></svg><span class="flex-1 pl-3 rounded-xl flex items-center font-semibold transition-colors group-hover:bg-primary/10">the other obligatory pyjail</span></a><!--]--></div><!--]--></div><div class="dotted-line-vert h-auto mb-10"></div></div><div class="relative flex flex-col items-center break-words max-w-[89rem] mx-auto px-[20.5rem] pt-24 pb-14 max-xl:ml-0 max-xl:pl-12 max-lg:mr-0 max-lg:pr-12 max-md:px-8 max-sm:px-5"><div class="w-full flex flex-col items-start"><span class="text-xl opacity-60 mb-1">03/10/2023</span><h1 class="mb-7">KPA</h1><div class="markdown mb-7 flex flex-col gap-y-3"><p>We've managed to grab an app from a suspicious device just before it got reset! The copying couldn't finish so some of the last few bytes got corrupted... But not all is lost! We heard that the file shouldn't have any comments in it! Help us uncover the secrets within this app!</p>
</div><div class="flex flex-wrap gap-3"><!--[--><div class="h-9 bg-white rounded-full flex items-center"><i class="material-symbols-outlined text-xl ml-3 mr-2 text-black">phone_android</i><span class="mr-4 text-black font-semibold">mobile</span></div><!--]--><div class="h-9 bg-almost-black rounded-full px-5 flex items-center"><span class="mr-4">86 solves</span><span class="opacity-60">0 points</span></div><div class="h-9 bg-almost-black rounded-full flex items-center"><i class="material-symbols-outlined text-xl ml-3 mr-3">person</i><span class="mr-4">by unknown</span></div></div><div class="w-full flex border border-almost-black-lighter rounded-2.5xl mt-7 mb-9 max-sm:flex-col"><div class="flex-1 flex flex-col gap-y-2 px-6 pt-4 pb-5"><span>Attachments</span><!--[--><a href="https://api.tisc.csit-events.sg/file?id=clmgec1pa2x3908868ief82yt&amp;name=kpa.apk" class="underline">kpa.apk</a><!--]--></div><button class="pl-9 pr-10 font-semibold flex items-center border-l border-almost-black-lighter rounded-tr-2.5xl rounded-br-2.5xl transition-colors hover:bg-almost-black active:bg-almost-black-lighter max-sm:border-l-0 max-sm:border-t max-sm:pl-6 max-sm:py-4 max-sm:rounded-tr-none max-sm:rounded-bl-2.5xl"><i class="material-symbols-outlined text-2xl mr-4">download</i> Download all </button></div></div><div id="article" class="markdown w-full flex flex-col gap-y-3 px-4 max-md:px-0"><h1 id="1.-fixing-the-apk" tabindex="-1">1. Fixing the apk</h1>
<p>When I first tried to decompile the apk with jadx, it produced an error and failed to decompile correctly. I remembered from the challenge description that "some of the last few bytes got corrupted", so I knew I had to fix the file before decompiling it. I searched for an apk file format specification online but realised an apk is a zip archive, so I used the specification <a href="https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip-printable.html">here</a> and edited the file using ghex.</p>
<p>Referring to the "end of central directory record" section, I realised that the comment length was set to \x0a\x00 = 10 bytes, although the challenge description specified "the file shouldn't have any comments". Hence, I just changed the byte to 0 and decompiled the modified apk. This time, it decompiled without errors.</p>
<h1 id="2.-static-analysis" tabindex="-1">2. Static analysis</h1>
<p>Next, I found MainActivity.java under sources/com/tisc/kappa/MainActivity.java, and I noticed an interesting method.</p>
<pre class="named-fence-block"><code class="language-java">public void M(String str) {
    char[] charArray = str.toCharArray();
    String valueOf = String.valueOf(charArray);
    for (int i2 = 0; i2 &lt; 1024; i2++) {
        valueOf = N(valueOf, "SHA1");
    }
    if (!valueOf.equals("d8655ddb9b7e6962350cc68a60e02cc3dd910583")) {
        ((TextView) findViewById(d.f3935f)).setVisibility(4);
        Q(d.f3930a, 3000);
        return;
    }
    char[] copyOf = Arrays.copyOf(charArray, charArray.length);
    charArray[0] = (char) ((copyOf[24] * 2) + 1);
    charArray[1] = (char) (((copyOf[23] - 1) / 4) * 3);
    charArray[2] = Character.toLowerCase(copyOf[22]);
    charArray[3] = (char) (copyOf[21] + '&amp;');
    charArray[4] = (char) ((Math.floorDiv((int) copyOf[20], 3) * 5) + 4);
    charArray[5] = (char) (copyOf[19] - 1);
    charArray[6] = (char) (copyOf[18] + '1');
    charArray[7] = (char) (copyOf[17] + 18);
    charArray[8] = (char) ((copyOf[16] + 19) / 3);
    charArray[9] = (char) (copyOf[15] + '%');
    charArray[10] = (char) (copyOf[14] + '2');
    charArray[11] = (char) (((copyOf[13] / 5) + 1) * 3);
    charArray[12] = (char) ((Math.floorDiv((int) copyOf[12], 9) + 5) * 9);
    charArray[13] = (char) (copyOf[11] + 21);
    charArray[14] = (char) ((copyOf[10] / 2) - 6);
    charArray[15] = (char) (copyOf[9] + 2);
    charArray[16] = (char) (copyOf[8] - 24);
    charArray[17] = (char) (copyOf[7] + Math.pow(4.0d, 2.0d));
    charArray[18] = (char) ((copyOf[6] - '\t') / 2);
    charArray[19] = (char) (copyOf[5] + '\b');
    charArray[20] = copyOf[4];
    charArray[21] = (char) (copyOf[3] - '\"');
    charArray[22] = (char) ((copyOf[2] * 2) - 20);
    charArray[23] = (char) ((copyOf[1] / 2) + 8);
    charArray[24] = (char) ((copyOf[0] + 1) / 2);
    P("The secret you want is TISC{" + String.valueOf(charArray) + "}", "CONGRATULATIONS!", "YAY");
}
</code><div class="named-fence-filename">MainActivity.java</div></pre>
<p>Unfortunately, it seems that <code>str</code> is user-entered, and there is no way to reverse the sha1 hashes, hence we have to look elsewhere. At this point, I installed the apk on my phone, and saw that there was the following dialog:</p>
<p><img src="/ctf-writeups/tisc23/kpa-screenshot.jpg" alt="Screenshot of the app"></p>
<p>I realised this is loaded by the onResume method:</p>
<pre class="named-fence-block"><code class="language-java">@Override // androidx.fragment.app.e, android.app.Activity
public void onResume() {
    super.onResume();
    O(j1.c.f3928a);
    new j1.b();
    if (j1.b.e()) {
        P("Suspicious device detected!", "CHECK FAILED", "BYE");
    }
    PackageManager packageManager = getPackageManager();
    new j1.a();
    if (j1.a.a(packageManager) == 20) {
        O(j1.c.f3929b);
        setContentView(e.f3937b);
        new sw();
        sw.a();
        ((Button) findViewById(d.f3934e)).setOnClickListener(new c());
        return;
    }
    O(j1.c.f3928a);
    setContentView(e.f3936a);
    if (j1.b.e()) {
        return;
    }
    ((TextView) findViewById(d.f3932c)).setAlpha(1.0f);
    ((TextView) findViewById(d.f3933d)).setAlpha(1.0f);
}
</code><div class="named-fence-filename">MainActivity.java</div></pre>
<p>It seems that some conditions are being checked, and depending on the outcome <code>setContentView</code> will be called with either <code>e.f3937b</code> or <code>e.f3936a</code>. I looked at the e.java class to find:</p>
<pre class="named-fence-block"><code class="language-java">package j1;
/* loaded from: classes.dex */
public abstract class e {

    /* renamed from: a  reason: collision with root package name */
    public static int f3936a = 2131427356;

    /* renamed from: b  reason: collision with root package name */
    public static int f3937b = 2131427358;
}
</code><div class="named-fence-filename">e.java</div></pre>
<p>Now we need to find the layout file with these ids. By conducting a global search for the hex value of these ids, I found these lines in resources/res/values/public.xml:</p>
<pre class="named-fence-block"><code class="language-xml">&lt;public type="layout" name="activity_main" id="0x7f0b001c" /&gt;
&lt;public type="layout" name="debug_activity_main" id="0x7f0b001e" /&gt;
</code><div class="named-fence-filename">public.xml</div></pre>
<p><code>activity_main</code> seems to be the layout that was loaded when I opened the app, however if the <code>j1.a.a(packageManager) == 20</code> condition is satisfied (it seems to check that a certain list of 20 packages are installed), <code>debug_activity_main</code> is loaded instead. I found the layout file under resources/res/layout/debug_activity_main.xml:</p>
<pre class="named-fence-block"><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:background="#8bffb8" android:layout_width="match_parent" android:layout_height="match_parent"&gt;
    &lt;TextView android:textSize="18sp" android:id="@+id/textView2" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="The secret you seek was just written somewhere..." android:textAlignment="center" app:layout_constraintBottom_toBottomOf="0" app:layout_constraintEnd_toEndOf="0" app:layout_constraintStart_toStartOf="0" app:layout_constraintTop_toTopOf="0" app:layout_constraintVertical_bias="0.366"/&gt;
    &lt;TextView android:textSize="34sp" android:typeface="normal" android:textStyle="bold" android:textColor="#292929" android:id="@+id/textView" android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Welcome to KaPpA!" android:autoText="false" android:textAllCaps="false" app:layout_constraintBottom_toBottomOf="0" app:layout_constraintEnd_toEndOf="0" app:layout_constraintStart_toStartOf="0" app:layout_constraintTop_toTopOf="0" app:layout_constraintVertical_bias="0.189"/&gt;
    &lt;Button android:id="@+id/submitButton" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="18dp" android:text="Submit!" android:layout_marginStart="157dp" android:layout_marginEnd="157dp" app:layout_constraintEnd_toEndOf="0" app:layout_constraintStart_toStartOf="0" app:layout_constraintTop_toBottomOf="@+id/inputText"/&gt;
    &lt;EditText android:id="@+id/inputText" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="102dp" android:layout_marginBottom="18dp" android:hint="Think you found it?" android:ems="10" android:inputType="text" android:textAlignment="center" android:layout_marginStart="100dp" android:layout_marginEnd="102dp" app:layout_constraintBottom_toTopOf="@+id/submitButton" app:layout_constraintEnd_toEndOf="0" app:layout_constraintStart_toStartOf="0" app:layout_constraintTop_toBottomOf="@+id/textView2" style="@style/Widget.AppCompat.EditText"/&gt;
    &lt;TextView android:textSize="20sp" android:textColor="#009688" android:id="@+id/success" android:visibility="invisible" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="56dp" android:text="Getting there..." android:layout_marginStart="160dp" android:layout_marginEnd="160dp" app:layout_constraintEnd_toEndOf="0" app:layout_constraintHorizontal_bias="0.503" app:layout_constraintStart_toStartOf="0" app:layout_constraintTop_toBottomOf="@+id/submitButton"/&gt;
    &lt;TextView android:textSize="20sp" android:textColor="#e91e63" android:id="@+id/failure" android:visibility="invisible" android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_marginTop="76dp" android:text="That&amp;apos;s not right..." android:layout_marginEnd="128dp" app:layout_constraintEnd_toEndOf="0" app:layout_constraintTop_toBottomOf="@+id/submitButton"/&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code><div class="named-fence-filename">debug_activity_main.xml</div></pre>
<p>So this is where the user keys in the secret, which is passed to the method we saw earlier. There is an important hint "The secret you seek was just written somewhere". Initially I thought it had been written to a file, so I took another look at the java code near where <code>setContentView</code> is called. the lines <code>new sw(); sw.a();</code> seemed interesting, so I looked at sw.java:</p>
<pre class="named-fence-block"><code class="language-java">package com.tisc.kappa;
/* loaded from: classes.dex */
public class sw {
    static {
        System.loadLibrary("kappa");
    }

    public static void a() {
        try {
            System.setProperty("KAPPA", css());
        } catch (Exception unused) {
        }
    }

    private static native String css();
}
</code><div class="named-fence-filename">sw.java</div></pre>
<p>Maybe the secret is stored in the kappa library, perhaps its written to a file when the library is loaded? I found the <code>libkappa.so</code> file under <code>resources/lib/x86_64/libkappa.so</code> and began to analyse it. I tried running strings and attempted to decompile it, however this wasn't successful. In the end, I used a more dynamic approach.</p>
<p>I simply created a new android app, copying the contents of <code>resources/lib</code> over to <code>jniLibs</code>, and copying the <code>sw.java</code> file. I created a separate line, <code>String s = css();</code>, and added a breakpoint right after that. When I debugged the app, I could see the secret in the variable <code>s</code>: <code>"ArBraCaDabra?KAPPACABANA!"</code></p>
<p>Now its just a matter of running the above method (<code>M</code>) to transform the string and print the flag. I made a few modifications to the code, and ran it on an online java compiler.</p>
<pre class="named-fence-block"><code class="language-java">import java.util.Arrays;

public class HelloWorld {
    public static void main(String[] args) {
        String str = "ArBraCaDabra?KAPPACABANA!";
        char[] charArray = str.toCharArray();
        String valueOf = String.valueOf(charArray);
        char[] copyOf = Arrays.copyOf(charArray, charArray.length);
        charArray[0] = (char) ((copyOf[24] * 2) + 1);
        charArray[1] = (char) (((copyOf[23] - 1) / 4) * 3);
        charArray[2] = Character.toLowerCase(copyOf[22]);
        charArray[3] = (char) (copyOf[21] + '&amp;');
        charArray[4] = (char) ((Math.floorDiv((int) copyOf[20], 3) * 5) + 4);
        charArray[5] = (char) (copyOf[19] - 1);
        charArray[6] = (char) (copyOf[18] + '1');
        charArray[7] = (char) (copyOf[17] + 18);
        charArray[8] = (char) ((copyOf[16] + 19) / 3);
        charArray[9] = (char) (copyOf[15] + '%');
        charArray[10] = (char) (copyOf[14] + '2');
        charArray[11] = (char) (((copyOf[13] / 5) + 1) * 3);
        charArray[12] = (char) ((Math.floorDiv((int) copyOf[12], 9) + 5) * 9);
        charArray[13] = (char) (copyOf[11] + 21);
        charArray[14] = (char) ((copyOf[10] / 2) - 6);
        charArray[15] = (char) (copyOf[9] + 2);
        charArray[16] = (char) (copyOf[8] - 24);
        charArray[17] = (char) (copyOf[7] + Math.pow(4.0d, 2.0d));
        charArray[18] = (char) ((copyOf[6] - '\t') / 2);
        charArray[19] = (char) (copyOf[5] + '\b');
        charArray[20] = copyOf[4];
        charArray[21] = (char) (copyOf[3] - '\"');
        charArray[22] = (char) ((copyOf[2] * 2) - 20);
        charArray[23] = (char) ((copyOf[1] / 2) + 8);
        charArray[24] = (char) ((copyOf[0] + 1) / 2);
        System.out.println("The secret you want is TISC{" + String.valueOf(charArray) + "}");
    }
}
</code><div class="named-fence-filename">s.java</div></pre>
<p>The flag was printed out: <code>TISC{C0ngr@tS!us0lv3dIT,KaPpA!}</code></p>
</div><div class="fixed w-[17.5rem] h-full top-0 right-0 pointer-events-none pr-8 max-lg:hidden"><!----></div></div><!----></div></div>
    
  

</body></html>